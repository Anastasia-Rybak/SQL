-- Задание 2.2.2.TSK.B: показать всех авторов со всеми написанными ими книгами и всеми жанрами, в которых они работали (дублирование имён авторов, названий книг и жанров не допускается).
SELECT GROUP_CONCAT(DISTINCT `a_name` ORDER BY `a_name` SEPARATOR ', ') AS `author(s)`, GROUP_CONCAT(DISTINCT `b_name` ORDER BY `b_name` SEPARATOR ', ') as `book(s)`,GROUP_CONCAT(DISTINCT `g_name` ORDER BY `g_name` SEPARATOR ', ') AS `genre(s)` FROM `books` JOIN `m2m_books_authors` USING(`b_id`) JOIN `authors` USING(`a_id`) JOIN `m2m_books_genres` USING(`b_id`) JOIN `genres` USING(`g_id`) GROUP BY `a_id` ORDER BY `a_name`