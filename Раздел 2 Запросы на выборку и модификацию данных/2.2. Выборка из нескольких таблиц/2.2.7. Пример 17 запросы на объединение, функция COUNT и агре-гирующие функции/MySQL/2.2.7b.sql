-- Задача 2.2.7.b{116}: показать самого читаемого автора, т.е. автора (или ав-торов, если их несколько), книги которого читатели брали чаще всего.
SELECT `a_id`, `a_name`, COUNT(`subscriptions`.`b_id`) AS `books` FROM `authors` JOIN `m2m_books_authors` USING (`a_id`) LEFT OUTER JOIN `subscriptions` ON `m2m_books_authors`.`b_id` = `subscriptions`.`b_id` GROUP BY `a_id` HAVING `books` = (SELECT MAX(`books`) FROM (SELECT COUNT(`subscriptions`.`b_id`) AS `books` FROM `authors` JOIN `m2m_books_authors` USING ( `a_id` ) LEFT OUTER JOIN `subscriptions` ON `m2m_books_authors`.`b_id` = `subscriptions`.`b_id` GROUP BY `a_id` ) AS `books_per_author`)