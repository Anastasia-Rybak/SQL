-- Задача 7.4.1.a{528}: написать запрос, показывающий по каждой выдаче книг номер дня недели (1 — понедельник, 2 — вторник и т.д.) и порядковый номер соответствующего дня недели в месяце (например, первый чет-верг месяца, вторая среда месяца и т.д.)
SELECT `sb_id`, `sb_start`, CASE WHEN WEEKDAY(`sb_start` - INTERVAL DAY(`sb_start`)-1 DAY) <= WEEKDAY(`sb_start`) THEN WEEK(`sb_start`, 5) - WEEK(`sb_start` - INTERVAL DAY(`sb_start`)-1 DAY, 5) + 1 ELSE WEEK(`sb_start`, 5) - WEEK(`sb_start` - INTERVAL DAY(`sb_start`)-1 DAY, 5) END AS `W`, WEEKDAY(`sb_start`) + 1 AS `D` FROM `subscriptions`